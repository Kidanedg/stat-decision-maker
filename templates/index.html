<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Statistical Decision Maker</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
    <div class="container">
        <h1 class="mb-4">Statistical Decision Maker</h1>

        <form method="POST" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="file" class="form-label">Upload CSV:</label>
                <input type="file" name="file" accept=".csv" class="form-control" required>
            </div>

            {% if columns %}
            <div class="mb-3">
                <label for="method" class="form-label">Choose Analysis Method:</label>
                <select name="method" class="form-select" required>
                    <option value="">-- Select Method --</option>
                    <option value="t-test" title="Compare means of two groups">Two-Sample t-Test</option>
                    <option value="anova" title="Compare means across multiple groups">ANOVA</option>
                    <option value="regression" title="Model relationship between two numeric variables">Linear Regression</option>
                    <option value="correlation" title="Check linear relationship between two numeric variables">Correlation</option>
                    <option value="chi-square" title="Test independence between two categorical variables">Chi-Square Test</option>
                    <option value="timeseries" title="Plot values across time or order">Time Series Plot</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="col1" class="form-label">Select Column 1:</label>
                <select name="col1" class="form-select" required>
                    {% for col in columns %}
                        <option value="{{ col }}">{{ col }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="col2" class="form-label">Select Column 2 (optional):</label>
                <select name="col2" class="form-select">
                    <option value="">-- None --</option>
                    {% for col in columns %}
                        <option value="{{ col }}">{{ col }}</option>
                    {% endfor %}
                </select>
            </div>
            {% endif %}

            <button type="submit" class="btn btn-primary">Submit</button>
        </form>

        {% if result %}
        <hr>
        <h3>Analysis Result:</h3>
        {% if result.error %}
            <div class="alert alert-danger">❌ {{ result.error }}</div>
        {% else %}
            <p><strong>{{ result.test }}</strong></p>
            {% if result.statistic %}
                <p>Statistic: {{ result.statistic }}</p>
                <p>p-Value: {{ result.p_value }}</p>
                <p><strong>Decision:</strong> {{ result.decision }}</p>
            {% endif %}

            {% if result.plot %}
                <h5>Plot:</h5>
                <img src="{{ url_for('static', filename=result.plot) }}" class="img-fluid" width="500">
            {% endif %}

            {% if result.csv %}
                <p><a href="{{ url_for('static', filename=result.csv) }}" class="btn btn-sm btn-outline-success">⬇ Download CSV Result</a></p>
            {% endif %}
        {% endif %}
        {% endif %}
    </div>
</body>
</html>
